@page "/account"

<PageTitle>Account</PageTitle>

<!-- Link external styles -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="AccountLayout.css">
<script src="Account.js"></script>
<div id="container" class="container @(IsSignUpActive ? "active" : "")">
    <!-- Sign-Up Form -->
    <div class="form-container sign-up">
        <EditForm Model="@registerModel">
            <h1>Create Account</h1>
            <InputText id="register-name" placeholder="Name" @bind-Value="registerModel.Name" />
            <InputText id="register-email" placeholder="Email" @bind-Value="registerModel.Email" />
            <InputText type="password" id="register-password" placeholder="Password" @bind-Value="registerModel.Password" autocomplete="new-password" />
            <InputText id="register-phone" placeholder="Phone" @bind-Value="registerModel.Phone" />
            <InputSelect id="register-role" @bind-Value="registerModel.Role">
                <option value="student">Student</option>
                <option value="employer">Employer</option>
            </InputSelect>
            <button type="submit">Sign Up</button>
        </EditForm>
    </div>

    <!-- Sign-In Form -->
    <div class="form-container sign-in"> 
        <EditForm Model="@loginModel">
            <h1>Sign In</h1>
            <InputText id="login-email" placeholder="Email" @bind-Value="loginModel.Email" />
            <InputText type="password" id="login-password" placeholder="Password" @bind-Value="loginModel.Password" autocomplete="current-password" />
            <button type="submit">Sign In</button>
        </EditForm>
    </div>

    <!-- Toggle Container -->
    <div class="toggle-container">
        <div class="toggle">
            <div class="toggle-panel toggle-left">
                <h1>Welcome Back, CoWorker!</h1>
                <p>Please sign in to continue.</p>
                <button class="toggle-button sign-in" @onclick="() => Toggle(false)">Sign In</button>
            </div>
            <div class="toggle-panel toggle-right">
                <h1>Hello, CoWorker!</h1>
                <p>Create an account to get started.</p>
                <button class="toggle-button sign-up" @onclick="() => Toggle(true)">Sign Up</button>
            </div>
        </div>
    </div>
</div>



@code {
    private LoginModel loginModel = new LoginModel();
    private RegisterModel registerModel = new RegisterModel();
    private bool IsSignUpActive { get; set; } = false;

    @inject IJSRuntime JSRuntime

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Ensure JS initialization after first render
            await JSRuntime.InvokeVoidAsync("initializeAccountToggle");
        }
    }

    private async Task Toggle(bool signUp)
    {
        IsSignUpActive = signUp;
        await InvokeAsync(StateHasChanged); // Re-render UI
    }

    public class LoginModel
    {
        public string Email { get; set; }
        public string Password { get; set; }
    }

    public class RegisterModel
    {
        public string Name { get; set; }
        public string Email { get; set; }
        public string Password { get; set; }
        public string Phone { get; set; }
        public string Role { get; set; }
    }
}
